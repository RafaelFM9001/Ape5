BROKER SCHEMA mx.gob.sat.matce.protocolobancos.lineacaptura

/*
*
* Autor: Oscar Daniel Jiménez Gutiérrez - Softtek
* Fecha de creación: Enero 2018 Version: 1.0
*/


CREATE COMPUTE MODULE GuardarTransaccionEnAmbiente
	CREATE FUNCTION Main() RETURNS BOOLEAN
	BEGIN
		IF EXISTS(Environment.MsgGenerarTransaccionRes.XMLNSC.Error[]) THEN
			SET OutputRoot.XMLNSC = Environment.MsgGenerarTransaccionRes.XMLNSC;
			PROPAGATE TO TERMINAL 'out4';
		END IF;
		
		--La respuesta del servicio de generación de transacción es almacenada en ambiente para posteriormente enviarla como respuesta al cliente
		SET Environment.respuestaTransaccion = Environment.MsgGenerarTransaccionRes.XMLNSC.*:generaTransaccionResponse.respuestaTransaccion;
		SET Environment.DetalleTransaccion.respuestaTransaccion = 'T'; --Código de que la solicitud se recibió exitosamente
		SET Environment.DetalleTransaccion.numTransaccion = Environment.respuestaTransaccion.numTransaccion;
		
		RETURN FALSE;
	END;
END MODULE;
